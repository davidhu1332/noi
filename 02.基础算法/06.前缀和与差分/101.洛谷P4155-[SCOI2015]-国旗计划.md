# 2.6.101 洛谷P4155-[SCOI2015]-国旗计划



### 题目描述

A 国正在开展一项伟大的计划 —— 国旗计划。这项计划的内容是边防战士手举国旗环绕边境线奔袭一圈。这项计划需要多名边防战士以接力的形式共同完成，为此，国土安全局已经挑选了 N名优秀的边防战上作为这项计划的候选人。

A 国幅员辽阔，边境线上设有$M$个边防站，顺时针编号 1 至$ M$。每名边防战士常驻两个边防站，并且善于在这两个边防站之间长途奔袭，我们称这两个边防站之间的路程是这个边防战士的奔袭区间。$N$名边防战士都是精心挑选的，身体素质极佳，所以每名边防战士的奔袭区间都不会被其他边防战士的奔袭区间所包含。

现在，国十安全局局长希望知道，至少需要多少名边防战士，才能使得他们的奔袭区间覆盖全部的边境线，从而顺利地完成国旗计划。不仅如此，安全局局长还希望知道更详细的信息：对于每一名边防战士，在他必须参加国旗计划的前提下，至少需要多少名边防战士才能覆盖全部边境线，从而顺利地完成国旗计划。

### 输入格式

第一行，包含两个正整数$N$,$M$，分别表示边防战士数量和边防站数量。

随后$N$ 行，每行包含两个正整数。其中第$ i $行包含的两个正整数$C_i$、$D_i$分别表示 i号边防战士常驻的两个边防站编号，$C_i$号边防站沿顺时针方向至 $D_i$号边防站力他的奔袭区间。数据保证整个边境线都是可被覆盖的。

### 输出格式

输出数据仅 1 行，需要包含$N$个正整数。其中，第$ j$个正整数表示$j$号边防战士必须参加的前提下至少需要多少名边防战士才能顺利地完成国旗计划。

$N⩽2×10^5, M<10^9, 1⩽C_i,D_i⩽M$。



### 分析细节

* 1、环形数据如何处理？ 化圆为线。
* 2、任意i，应该如何最优的下一跳？显然只需要左端点在$[C, D]$范围内的区间都是符合要求的。那么越接近D越好。可以先对所有区间根据左端点排序，然后贪心找到最优下一跳。
* 3、排序后，每个区间都乱序了，怎么才能按顺序$1\dots n$输出呢？区间结构体增加$id$，记录区间$id$。
* 4、化圆为线是在排序前还是排序后？ 显然应该是排序后。
* 5、复制$[1\dots n]$到$[n+1\dots 2\times n]$，怎么调整$L$和$R$? 只需要对应的$L$和$R$分别增加$M$，$node[N + i].L = node[i].L + M$
* 6、任意$i$，要一圈需要$N$复杂度，对所有点都需要查询，需要$O(N^2)$。能否把“跳跃”数量从$N$降低到log(N)呢？
* 7、倍增思想。先处理所有点的最优下一跳$dp[i][0]$，然后依次计算跳跃$2^j$个区间。$dp[i][j]=dp[dp[i][j-1]][j-1]$。每次先跳$2^{j-1}$到$dp[i][j-1]$，然后再从$dp[i][j-1]$跳跃$2^{j-1}$到达$dp[i][j]$。这里跳跃的单位是区间，跳跃的数量是区间个数。
* 8、查询细节。$log(N)$查询需要注意从大到小。
* 9、查询按照排序后的顺序查询，如何按$1\dots n$输出呢？保存结果的时候用$id$作为下标即可。



### 代码实现细节

```c++




```

